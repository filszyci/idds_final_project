create table if not exists movies_transactions.casts (
	cast_id INT, #autogenerated
	movie_id INT,
	actor_id INT,
	`character` VARCHAR(255),
	`order` INT,
	primary key (cast_id),
	constraint fk_movie_cast foreign key (movie_id) references movies_transactions.movies(movie_id),
	constraint fk_actor_cast foreign key (actor_id) references movies_transactions.actors(actor_id)
);
alter table movies_transactions.casts auto_increment=1;

insert into movies_transactions.casts (cast_id, movie_id, actor_id, `character`, `order`)
select 
	row_number() over () as cast_id,
	movie_id,
	actor_id,
	`character`,
	`order` 
from (
	select distinct
		movie_id,
		actor_id,
		`character`,
		`order`
	from movies_raw.casts) c;

ALTER TABLE movies_transactions.casts ADD COLUMN `character` VARCHAR(500);