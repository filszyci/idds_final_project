create table if not exists movies_transactions.crews (
	crew_id INT, #autogenerated
	movie_id INT,
	member_id INT,
	department VARCHAR(255),
	job VARCHAR(255),
	constraint pk_crew primary key (crew_id),
	constraint fk_member_crew foreign key (member_id) references movies_transactions.members(member_id),
	constraint fk_movie_crew foreign key (movie_id) references movies_transactions.movies(movie_id)
);
alter table movies_transactions.crews auto_increment=1;

insert into movies_transactions.crews (crew_id, movie_id, member_id, department, job)
select 
	row_number() over () as crew_id,
	movie_id,
	member_id,
	department,
	job 
from (
	select distinct 
		movie_id,
		credit_id as member_id,
		department,
		job
	from movies_raw.crews c) d;